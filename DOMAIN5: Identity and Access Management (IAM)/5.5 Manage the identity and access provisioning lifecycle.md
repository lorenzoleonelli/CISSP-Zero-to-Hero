## 5.5.0 Preface ##

**Provisioning and Deprovisioning** are key processes in access management, ensuring that users have the appropriate level of access to systems, data, and resources throughout their lifecycle. These processes are fundamental to maintaining security, regulatory compliance, and operational efficiency.

Provisioning is the act of creating and granting access to user accounts, typically during the onboarding process. This process involves several key actions, including verifying the user's identity, determining the appropriate level of access, and configuring user accounts to meet specific access requirements.

Provisioning goes beyond just creating a username and password. It also involves assessing the user’s roles, responsibilities, and required access to resources based on business needs and security policies. In some cases, multi-factor authentication (MFA) may be required as part of provisioning to ensure the user's identity is verified before granting access. The provisioning process must be handled with care to ensure that users are given the least amount of access necessary to perform their job (a principle known as **least privilege**), which minimizes security risks.

- **Identity Proofing**: One of the first steps in provisioning is to confirm that the user is who they say they are. This could involve verifying government-issued IDs, using biometric systems, or employing multi-factor authentication (MFA).

- **Access Request Approval**: Access requests, such as those for specific applications or data, are reviewed and approved by designated personnel based on the user's role and business need. This ensures that permissions are granted only after careful evaluation and approval.

- **Automated Provisioning**: In larger organizations, provisioning is often automated using identity and access management (IAM) systems. These systems can integrate with human resources (HR) or enterprise resource planning (ERP) systems to automatically provision accounts and roles based on job titles or department assignments, significantly reducing human error and administrative workload.

Deprovisioning refers to the process of removing or adjusting a user's access to systems and resources when they no longer require it. This is an essential security practice to ensure that former employees, contractors, or other users who no longer need access do not retain permissions to sensitive resources.
There are several reasons why deprovisioning is necessary:

- Role Change: If an employee changes roles, their previous access rights may be inappropriate or excessive for their new role. For example, a sales manager who moves to the marketing department should have their access to financial systems and sales databases reviewed and possibly revoked.


- Termination or Resignation: When an employee leaves the organization, either voluntarily or involuntarily, all access permissions should be revoked immediately to prevent unauthorized access to company resources. Similarly, for contractors, their access should be terminated once their contract ends.


- System Decommissioning: If a system or application is being retired, access to that system should be deactivated during the decommissioning process.

The deprovisioning process can involve a variety of actions, depending on the organization's policies and the level of access granted:

- Revoking Access: Access rights are taken away from a user without deleting the account. This is typically the first step in deprovisioning. For example, an employee who leaves may have their login credentials disabled or locked.

- Disabling Accounts: In some cases, accounts are disabled but not deleted. This is important for auditing and compliance reasons, as the account may need to remain in the system for record-keeping or historical purposes, such as tracing activities back to the individual.

- Deleting Accounts: As a final step, some organizations may delete user accounts entirely, particularly in the case of system or service account deactivation. However, most systems retain a record of deleted accounts for compliance and auditing purposes.

Regular reviews of user access permissions are essential to ensure that only those who need access to certain systems have it. Over time, user roles may change, new risks may emerge, and previous access decisions may no longer align with the organization’s current business needs. Therefore, periodic reviews of user access, sometimes referred to as access certification or access recertification, help identify:

- Excessive Permissions: Users may accumulate excessive permissions over time, either due to role changes, system migrations, or human error. Regular reviews help catch instances where access has been unnecessarily granted.

- Inactive Accounts: Accounts belonging to users who are no longer employed or engaged with the organization should be flagged and deactivated or deleted to reduce the potential for misuse.

- Undeleted Accounts: If an account was not deprovisioned correctly, periodic reviews will help identify such instances so corrective action can be taken.

Reviews should involve both automated and manual checks. For example, an automated system can flag accounts with excessive privileges or inactivity, but a human administrator should verify the findings and make decisions based on context. This process ensures that access control decisions remain aligned with the organization's security policies and business requirements.

To ensure effective access management, organizations should follow best practices for provisioning, deprovisioning, and periodic reviews:

1. Automation: Automated provisioning and deprovisioning help streamline the process, reduce errors, and speed up the removal of access when necessary.

2. Least Privilege: Always assign the minimum access rights necessary for users to perform their job functions, and regularly review permissions to ensure they remain appropriate.

3. Separation of Duties: Implement controls to ensure that the individuals responsible for provisioning and deprovisioning access are different from those who are responsible for auditing and reviewing access.

4. Audit Trails: Maintain detailed logs of provisioning and deprovisioning actions. These logs are essential for troubleshooting, compliance audits, and investigating potential security breaches.

5. Accountability: Make sure that all access decisions are well-documented and that appropriate personnel are notified when a user’s access rights change.

### Open Questions ###

1. What is the purpose of Provisioning in access management, and what are its key actions?  
<details>
  <summary>Show answer</summary>
Provisioning refers to the process of creating and granting user access to systems, data, and resources. It involves verifying the user's identity, assessing their role, determining the level of access required, and configuring their account, often including multi-factor authentication for additional security.
</details>

2. How does Identity Proofing contribute to the Provisioning process?  
<details>
  <summary>Show answer</summary>
Identity Proofing ensures that the user is genuinely who they say they are by verifying their identity through means such as government-issued IDs, biometrics, or multi-factor authentication. This step is crucial to avoid granting access to unauthorized individuals during the Provisioning process.
</details>

3. What is the importance of Access Request Approval in provisioning user access?  
<details>
  <summary>Show answer</summary>
Access Request Approval involves reviewing access requests based on a user's role and business needs before granting access. This process ensures that permissions are not given arbitrarily, maintaining security by only allowing access that is necessary for a user's responsibilities.
</details>

4. How does Automated Provisioning improve efficiency and reduce errors in large organizations?  
<details>
  <summary>Show answer</summary>
Automated Provisioning reduces human error and administrative workload by using identity and access management (IAM) systems that integrate with HR or ERP systems to automatically provision accounts and assign roles based on job titles or department assignments, improving efficiency in large organizations.
</details>

5. What is the difference between Provisioning and Deprovisioning in access management?  
<details>
  <summary>Show answer</summary>
Provisioning involves creating and granting access, while Deprovisioning involves revoking or adjusting access when a user no longer needs it. Deprovisioning ensures that users, such as former employees or contractors, do not retain unnecessary access to systems or sensitive data.
</details>

6. Why is Deprovisioning necessary when an employee or contractor leaves an organization?  
<details>
  <summary>Show answer</summary>
Deprovisioning is necessary when an employee or contractor leaves to ensure that their access is promptly revoked. This step prevents unauthorized access to systems and resources that could lead to security breaches, data loss, or misuse of company information.
</details>

7. What actions can be involved in Deprovisioning a user's access?  
<details>
  <summary>Show answer</summary>
Deprovisioning actions may include:  
- **Revoking Access:** Taking away access rights without deleting the account.  
- **Disabling Accounts:** Temporarily disabling accounts while keeping them for auditing purposes.  
- **Deleting Accounts:** Removing the user’s account entirely, typically for system or service accounts.  
</details>

8. Why are Regular Reviews of User Access Permissions essential for an organization’s security?  
<details>
  <summary>Show answer</summary>
Regular Reviews of User Access Permissions are essential because over time, user roles and business needs change. Periodic reviews help identify excessive permissions, inactive accounts, or undeleted accounts, ensuring access permissions align with current security policies and organizational requirements.
</details>

9. What are some Best Practices for provisioning, deprovisioning, and reviewing access management?  
<details>
  <summary>Show answer</summary>
Best Practices for access management include:  
- **Automation:** Streamline provisioning and deprovisioning to reduce errors.  
- **Least Privilege:** Assign the minimum access necessary for users to perform their roles.  
- **Separation of Duties:** Ensure different personnel handle provisioning/deprovisioning and audits.  
- **Audit Trails:** Maintain logs for troubleshooting, audits, and security investigations.  
- **Accountability:** Ensure proper documentation of all access decisions and notify relevant personnel when changes are made.  
</details>

10. What role does Audit Trails play in effective access management?  
<details>
  <summary>Show answer</summary>
Audit Trails are critical because they maintain a record of provisioning and deprovisioning actions, allowing organizations to track changes in user access, investigate potential breaches, and ensure compliance with security and regulatory requirements.
</details>

## 5.5.1 Account access review (e.g., user, system, service) ##

User accounts are typically associated with individual users, while system accounts are used for nonhuman access needs, often for executing system functions such as backups, maintaining databases, or performing automated processes on behalf of a user. System accounts may also include accounts for devices like Internet of Things (IoT) devices or system Application Programming Interface (API) calls. Both types of accounts, whether user or system-related, should undergo regular reviews to ensure that access is granted only to the necessary resources and functions. These reviews ensure that access aligns with the organization’s security policies and operational needs.

When developing an access review policy, security professionals must consider multiple factors, including legal and regulatory requirements, as well as the sensitivity of the accounts involved. For instance, non-administrative accounts may be reviewed annually, while administrative accounts are often reviewed more frequently, such as on a quarterly basis, due to the higher level of risk associated with improper access. The potential damage from an unauthorized administrative account justifies these more frequent reviews.

The access review process includes evaluating several elements for each account. These elements include the systems and data the user can access, the actions they are permitted to take (such as read, write, or delete), and whether any access rights are excessive (for example, if an employee who does not require administrative access has been granted administrative privileges). It's important to look for dormant accounts, particularly those belonging to former employees or individuals who have changed roles, as well as to detect any "toxic combinations" of access, where a user’s privileges might conflict with policies like separation of duties, creating potential security risks.

System and service accounts, which are less likely to change compared to user accounts, also require regular reviews, albeit at a lower frequency. These accounts can still pose security risks, especially if they have unnecessary privileges or remain active when they are no longer needed. For example, if a default administrator account is left enabled after troubleshooting, it can become a security vulnerability. Similarly, accounts may be granted escalated privileges by default, even if those permissions are not required by the service. In these cases, access reviews should function like configuration audits to ensure that account privileges align with the secure baseline.

Access reviews can be time-consuming and disruptive, particularly if an account is mistakenly flagged as having inappropriate access. To mitigate this challenge, automating the review process is crucial. Tools such as Security Information and Event Management (SIEM) systems or Security Orchestration, Automation, and Response (SOAR) platforms can streamline the process by providing proactive controls, such as disabling inactive accounts after a certain period. The failure to conduct regular access reviews can lead to unauthorized access, which might be exploited by insider threats or external attackers who have gained access to a valid user account. Therefore, timely access reviews are essential to maintaining a secure environment and ensuring that access controls remain effective.

:bulb: SIEM (Security Information and Event Management) is a system that collects, analyzes, and correlates security data in real-time to detect threats, while SOAR (Security Orchestration, Automation, and Response) automates incident response and security operations tasks. Both can be helpful in account access reviews by automating the process of identifying suspicious access patterns, generating alerts for abnormal activities, and implementing corrective actions like disabling inactive accounts, thus enhancing security and efficiency.

## 5.5.2 Provisioning and deprovisioning (e.g., on/off boarding and transfers) ##

Provisioning refers to the process of granting or creating access for users, while deprovisioning is the reverse action, which may involve suspending, terminating, or deleting access. These processes are commonly triggered by personnel changes such as hiring, role changes, or employee departures. However, they are often managed by HR or IT teams, so it's crucial for security teams to collaborate with these departments to ensure that security measures are integrated and followed throughout the process.

Deprovisioning is particularly critical to mitigate the risk of unauthorized access by users who no longer require it. Access reviews are necessary to verify the systems and data a user had access to and confirm that their credentials have been properly deactivated. The process should account for different scenarios, such as hostile or involuntary terminations, where faster action is required due to increased risk; voluntary departures like resignations, which may be handled more slowly; and job role changes, where access should be completely deprovisioned before new permissions are granted.

:necktie: Deprovisioning takes place not only when a user leaves a company but also when a user changes role.

In systems that support self-provisioning or self-deprovisioning, such as online platforms where users manage their own accounts, security controls like Role-Based Access Control (RBAC) must be carefully designed. In these systems, it is essential to adhere to identity proofing requirements and ensure that access and data associated with users are handled according to privacy regulations.

## 5.5.3 Role definition and transition (e.g., people assigned to new roles) ##

Roles simplify the process of managing access by creating a predefined set of access rights for all users within a specific role. For instance, an organization may create roles based on departments, so employees in the IT department would receive access to IT-related systems, while finance employees would only have access to finance systems. When a new employee joins, they are assigned to a role, which automatically grants them the necessary access, streamlining the provisioning process.

By using roles, access management becomes more efficient since only a single action is required to grant or revoke access across multiple systems. Role definitions should adhere to access control principles such as least privilege, ensuring users only have the minimum access needed for their duties. Additionally, roles can help enforce security controls, like separation of duties. For example, non-HR users might be given write access to an HR system to upload personal data but denied read access to prevent querying sensitive information. A role-to-system matrix can help visually manage and track these access rights.

## 5.5.4 Privilege escalation (e.g., use of sudo, auditing its use) ##

Privilege escalation refers to the process where a user gains higher access levels than initially authorized. This can happen through bugs or vulnerabilities that allow a user with lower privileges, such as read-only access, to execute actions typically reserved for higher-level users, like writing data. Escalating privileges can lead to significant security risks, including loss of confidentiality, integrity, and availability, as users may be able to alter critical systems or data.

In certain situations, privilege escalation is necessary for performing administrative tasks that go beyond a user's regular permissions. For example, instead of constantly using an administrator account, a system might implement a “break-the-glass” model, where privileged access is granted only when needed. Tools like sudo in Unix or credential vaults allow administrators to temporarily elevate their privileges for specific tasks, often with security measures like logging or alerting in place to track this access.

:bulb: A Privileged Access Management (PAM) system is designed to manage and monitor access to critical systems and sensitive data by privileged users, such as system administrators. It works by enforcing strict controls on who can access privileged accounts, when, and for what purpose, often requiring multi-factor authentication (MFA) and session recording to ensure accountability. PAM tools typically include features like vaulting credentials, rotating passwords, and providing real-time monitoring of privileged access to prevent misuse or unauthorized activity.

An effective Identity and Access Management (IAM) system can minimize the risk of privilege escalation by restricting access to sensitive accounts, ensuring administrative privileges are used only when necessary. For instance, an admin might not need elevated privileges to browse the web, and this limitation helps mitigate the risk of accidentally or maliciously exploiting those privileges through common tasks like web browsing.

:bulb: In Linux systems, sudo (short for "superuser do") allows a permitted user to execute commands with the privileges of another user, typically the root user. When a user runs a command with sudo, the system checks the /etc/sudoers file to verify if the user has the necessary permissions to execute that command. If authorized, sudo temporarily elevates the user's privileges to perform the task, and logs the command for auditing purposes.

:bulb: In Windows systems, the "Run as" feature allows a user to execute a program with the permissions of another user, typically an administrator. When a user selects "Run as" and provides the credentials of a user with elevated privileges, the system executes the command under that user's security context. This allows the user to perform tasks that require administrative rights without needing to permanently log in as an administrator.

## 5.5.5 Service accounts management ##

Service accounts are specialized accounts used by applications, services, or automated tasks, rather than individual users. These accounts are crucial for system operations, enabling processes like backups, updates, or system maintenance to run smoothly. However, since service accounts typically have broad access to critical systems, they present significant security risks if not properly managed, such as being exploited for privilege escalation or impersonation.

To mitigate these risks, best practices recommend that service accounts be restricted to a single purpose and granted only the minimal privileges required for their intended function. This principle of least privilege is vital to ensuring that service accounts do not become an avenue for attacks. Additionally, human oversight is essential to ensure these accounts remain secure, even though they are not actively used by people. Regular monitoring and auditing of service account activity are necessary to detect any potential misuse or vulnerabilities.

### Open Questions ###

1. What is the main difference between user accounts and system accounts?  
<details>
  <summary>Show answer</summary>
User accounts are associated with individual users and their activities, while system accounts are used for nonhuman access needs such as backups, database maintenance, IoT devices, or API calls.  
</details>

2. Why should both user and system accounts undergo regular access reviews?  
<details>
  <summary>Show answer</summary>
Regular reviews ensure that accounts have access only to necessary resources and functions, aligning with security policies and operational needs. They also help identify excessive privileges or dormant accounts.  
</details>

3. How often should administrative accounts typically be reviewed compared to non-administrative accounts?  
<details>
  <summary>Show answer</summary>
Non-administrative accounts may be reviewed annually, while administrative accounts are reviewed more frequently, often quarterly, due to the higher risks associated with unauthorized access.  
</details>

4. What elements are evaluated during an access review?  
<details>
  <summary>Show answer</summary>
Reviews examine the systems and data accessible to the account, the actions permitted (read, write, delete), whether any rights are excessive, and if dormant or toxic combinations of privileges exist.  
</details>

5. Why do system and service accounts, even though rarely changing, still require reviews?  
<details>
  <summary>Show answer</summary>
They can pose risks if they retain unnecessary privileges, remain active when no longer needed, or use default administrator accounts left enabled, all of which can create vulnerabilities.  
</details>

6. How can automation tools like SIEM and SOAR improve the access review process?  
<details>
  <summary>Show answer</summary>
They streamline reviews by disabling inactive accounts automatically, detecting abnormal access patterns, generating alerts, and reducing manual workload and errors.  
</details>

7. What risks arise if access reviews are not performed regularly?  
<details>
  <summary>Show answer</summary>
Failure to review accounts can result in unauthorized access, insider threats, or external attackers exploiting valid but unused or overprivileged accounts.  
</details>

8. What is provisioning, and how does it differ from deprovisioning?  
<details>
  <summary>Show answer</summary>
Provisioning is the process of granting or creating access for a user, while deprovisioning is the revocation, suspension, or deletion of access when it is no longer required, such as during offboarding or role changes.  
</details>

9. Why is deprovisioning critical in cases of employee termination or role transition?  
<details>
  <summary>Show answer</summary>
It prevents former employees or users in new roles from retaining access they no longer need, reducing the risk of data misuse, breaches, or policy violations.  
</details>

10. What are best practices for managing service accounts?  
<details>
  <summary>Show answer</summary>
Service accounts should be limited to a single purpose, granted only the minimum privileges necessary, regularly monitored and audited, and managed with human oversight to prevent misuse.  
</details>






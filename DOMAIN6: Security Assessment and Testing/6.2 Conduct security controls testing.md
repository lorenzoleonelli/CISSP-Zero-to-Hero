## 6.2.1 Vulnerability Assessment ##

In cybersecurity, vulnerabilities must be clearly described so that both humans and automated systems can communicate about them. Several naming standards and scoring systems exist to help standardize vulnerability data across the industry.

**SCAP (Security Content Automation Protocol)** is a framework developed by NIST (National Institute of Standards and Technology) to automate the process of checking systems for vulnerabilities and configuration issues. SCAP combines multiple standards under one umbrella so tools can speak the same language.

:link: [Security Content Automation Protocol SCAP.](https://csrc.nist.gov/projects/security-content-automation-protocol)

**CVE (Common Vulnerabilities and Exposures)** assigns a unique ID to every known vulnerability. For example: CVE-2023-12345.
This makes it easy to reference the same issue across vendors, tools, and reports. CVE entries contain a short description, a publication date, and links to advisories and patches.

:link: [https://cve.mitre.org/](https://www.cve.org/)

These standards help automate vulnerability discovery, analysis, and reporting, making security assessments faster, more reliable, and easier to maintain:

| Standard | Purpose | Key Features | Example / Use Case |
|----------|----------|--------------|---------------------|
| **CVSS** (Common Vulnerability Scoring System) | Assigns a severity score (0.0–10.0) to vulnerabilities | Considers exploitability, confidentiality, integrity, availability, and environmental factors | A vulnerability with CVSS 9.8 is prioritized for immediate patching |
| **CCE** (Common Configuration Enumeration) | Identifies insecure system configurations | Provides unique IDs for misconfigurations instead of software bugs | Example: Windows Server allows weak password hashes |
| **CPE** (Common Platform Enumeration) | Standardized naming for software, hardware, and OS | Ensures scanners match the correct software version to vulnerabilities | “cpe:2.3:a:microsoft:office:2019” used in a vulnerability database |
| **XCCDF** (eXtensible Configuration Checklist Description Format) | Defines structured security checklists and rules | Provides pass/fail criteria for compliance assessments | An XCCDF file specifies Linux hardening rules (e.g., disable root SSH login) |
| **OVAL** (Open Vulnerability and Assessment Language) | Machine-readable vulnerability definitions | Scanners use OVAL tests to check system compliance automatically | Detecting if a patch is missing by running OVAL-defined checks |

A **vulnerability scan** inspects systems for known security weaknesses. These scans compare system data against vulnerability databases and known exploit conditions. Tools like Nessus, OpenVAS, Qualys, or Nexpose perform these scans and typically check for:
- Missing patches
- Default or weak configurations
- Exposed ports and services
- Known software flaws (linked to CVEs)

Vulnerability scanning can be done with or without credentials:
- Unauthenticated scan: limited to external inspection (open ports, service banners).
- Authenticated scan: allows deeper inspection of patch levels, file permissions, and configurations.

Before doing a vulnerability scan, security teams often run a **discovery scan** to find out what devices and systems exist on the network, because you can’t protect what you don’t know about. Discovery scans tell you which machines are online, what services are running, and which ports are open, which helps you make a complete inventory. When you scan a network, you also learn about the status of ports, which are like digital doors that let data in and out of a system. Ports can be open, which means the door is wide open and a service is ready to accept connections; closed, which means the door is shut but the system is reachable; filtered, which means the firewall is hiding the port so you can’t easily tell if it’s open or closed; or unfiltered, which means the port is reachable but the scanner can’t determine its exact state. Understanding these port states helps you see which systems are exposed to the internet or the internal network, and where attackers might focus their efforts. When it comes to scanning for vulnerabilities, you can focus on the whole network or specialize by type of system. For example, network vulnerability scans are used to check servers, routers, printers, and computers to see if there are weak spots like old software, unpatched services, misconfigurations, or exposed administration interfaces. 

If the focus is on websites and web applications, you would use a **web vulnerability scanner**, which looks for problems like SQL injection, where an attacker can trick the website into running malicious database commands, or cross-site scripting, where attackers inject code into pages that other users see. Web scanners also check if sensitive data is protected with encryption, if session tokens are secure, and if security headers are missing. 

**Databases** also have their own types of security scans, because they often store sensitive business or customer information. A database scan looks for things like weak passwords, insecure settings, missing updates, or excessive user permissions that allow people to access more data than they should. 

After scanning is done and all potential problems are found, the real work begins — which is managing the vulnerabilities. This is called the vulnerability management process, and it helps you handle problems in a way that is organized and reduces risk. First, you must keep a complete and up-to-date list of all devices, servers, and systems in your organization, because if you miss something, you won’t be scanning it or fixing it, and attackers might find it first. Then, when vulnerabilities are identified by your scanner, each finding must be carefully reviewed to make sure it’s a real issue and not a false alarm. Some vulnerabilities look dangerous but are not exploitable on your system due to specific configurations or other defenses. After confirming the real risks, the next step is to prioritize them, because not all problems are equally urgent. Security teams usually rely on the CVSS score, the importance of the affected system, and whether the vulnerability is known to be exploited in real-world attacks. Critical vulnerabilities on systems exposed to the internet are usually fixed first, especially if the system stores customer data or controls important business functions. Once you know which vulnerabilities need fixing, the next step is remediation, which means applying patches, changing settings, disabling risky services, or putting extra protections in place. If the vulnerability can’t be fixed immediately, you might reduce the risk temporarily by blocking network access or isolating the affected system. After the fix is applied, you should always check to make sure the problem is really solved, either by running another scan or testing manually. Finally, everything should be recorded in reports, so the organization can keep track of which systems were affected, how long it took to fix them, and what the overall risk level is. These reports also help show auditors and regulators that the company takes security seriously. Over time, security teams look for patterns and try to improve their processes, so fewer vulnerabilities slip through the cracks in the future. This whole cycle — from discovering systems, scanning for problems, fixing them, verifying the fixes, and reporting results — repeats continuously, because new vulnerabilities are discovered all the time, and old systems can fall out of compliance as software ages or new configurations are deployed. Security assessments are a core part of making sure your systems are protected against both known and unknown threats, and when done regularly and carefully, they greatly reduce the risk of data breaches, downtime, and costly cyberattacks.

| Step | Description | Key Points |
|------|-------------|------------|
| **1. Asset Inventory** | Maintain an up-to-date list of devices, servers, and systems. | Missing assets = unscanned, unprotected, exploitable by attackers. |
| **2. Vulnerability Identification** | Use scanners to find potential problems. | Review carefully to confirm real issues and filter false positives. |
| **3. Risk Validation** | Assess whether vulnerabilities are truly exploitable in your environment. | Some may look severe but aren’t exploitable due to configs/defenses. |
| **4. Prioritization** | Rank vulnerabilities by urgency. | Consider CVSS score, criticality of the system, and known exploits. |
| **5. Remediation** | Fix vulnerabilities by patching, changing configs, disabling risky services, or adding protections. | If not possible immediately, apply temporary risk reduction (e.g., block network access). |
| **6. Verification** | Confirm that fixes worked. | Re-scan or manually test to ensure vulnerabilities are resolved. |
| **7. Reporting** | Document vulnerabilities, fixes, timelines, and risk levels. | Reports show accountability and compliance for auditors/regulators. |
| **8. Continuous Improvement** | Analyze trends and refine processes. | Goal: reduce recurring issues, improve speed/effectiveness. |
| **Ongoing Cycle** | Repeat scanning and fixing continuously. | New vulnerabilities appear constantly; old systems can drift out of compliance. |

### Open Questions ###

1. Why do we need naming standards like CVE when dealing with cybersecurity vulnerabilities?

<details> <summary>Show answer</summary> Naming standards like CVE allow everyone — vendors, researchers, security tools — to talk about the same vulnerability using a common label. This avoids confusion and ensures consistency across reports, patches, and alerts. </details>

2. What is the purpose of the CVSS score when evaluating vulnerabilities?

<details> <summary>Show answer</summary> The CVSS score helps security teams understand how severe a vulnerability is, and decide how urgently it needs to be fixed. High scores mean the vulnerability is easier to exploit or causes more damage. </details>

3. How does CPE help scanners during a vulnerability assessment?

<details> <summary>Show answer</summary> CPE makes sure that scanners match the correct vulnerability to the exact software, hardware, or operating system version. This reduces false alarms and ensures only relevant issues are reported. </details>

4. What makes SCAP important in security automation?

<details> <summary>Show answer</summary> SCAP helps different security tools use the same rules and formats to automatically check systems for vulnerabilities and misconfigurations, making security checks faster and more reliable. </details>

5. Why is OVAL useful when scanning for vulnerabilities?

<details> <summary>Show answer</summary> OVAL turns vulnerability descriptions into machine-readable checks, so automated tools can scan systems without human interpretation, improving speed and consistency. </details>

6. What does an XCCDF file do in a security assessment?

<details> <summary>Show answer</summary> XCCDF defines security rules in a structured format that tools can follow, helping automate the process of verifying system configurations and hardening servers against attacks. </details>

7. Why are vulnerability scans usually combined with discovery scans?

<details> <summary>Show answer</summary> Discovery scans help identify all the devices and services on a network, making sure that vulnerability scans don’t miss systems that are unknown or hidden. </details>

8. What can you learn by checking the state of a network port during a scan?

<details> <summary>Show answer</summary> By checking port states, you can learn if a service is running and reachable (open), blocked (filtered), disabled (closed), or uncertain (unfiltered). This helps detect exposure points for potential attacks. </details>

9. How does web vulnerability scanning differ from network vulnerability scanning?

<details> <summary>Show answer</summary> Web vulnerability scanning focuses on flaws in websites and apps, like SQL injection or broken encryption, while network vulnerability scanning targets devices, services, and configurations on a broader network level. </details>

10. Why is vulnerability management more than just scanning?

<details> <summary>Show answer</summary> Vulnerability management includes identifying, validating, prioritizing, fixing, and verifying vulnerabilities. This structured approach prevents attackers from exploiting known issues and helps maintain long-term security. </details>

---

## 6.2.2 Penetration testing (e.g., red, blue, and/or purple team exercises) ##

Penetration testing, often called **pentesting**, is a security testing method where ethical hackers simulate real-world attacks on systems, networks, applications, or even physical locations to find weaknesses before malicious attackers do. The goal of penetration testing is to identify vulnerabilities in a controlled and safe way, so that companies can fix them before they are exploited. Pentesters act like real attackers, but with permission from the company, and usually follow a carefully agreed plan to avoid damage or disruption.

There are different types of penetration testing, depending on how much information the tester is given before the test begins. The three most common types are white box, gray box, and black box testing. 

| Test Type | Knowledge Provided | Simulates | Strengths | Limitations | Typical Use Cases |
|-----------|--------------------|-----------|-----------|-------------|-------------------|
| **White box testing** | Full knowledge — architecture diagrams, source code, config files, sometimes admin access. | Insider attack or attacker who already has extensive internal info. | Very deep analysis; finds design flaws, insecure configs, and code-level issues; efficient at locating logic bugs. | Less realistic for external attacks; may miss issues an external attacker would exploit through discovery. | Code reviews, secure SDLC checks, deep application or system audits. |
| **Gray box testing** | Partial knowledge — some credentials or network details, but no full source/config access. | Attacker with limited insider access (e.g., employee or compromised account) trying to escalate or move laterally. | Good balance of realism and depth; can find privilege escalation and lateral-movement issues; more focused than black box. | May still miss deep code-level problems; depends on the quality of partial info provided. | Web app tests with user-level access, internal web services, employee-facing systems. |
| **Black box testing** | No internal knowledge — tester uses public info, open ports, and visible services only. | External attacker approaching from the internet or public networks. | Very realistic for external threats; tests discovery and external attack surface; useful for public-facing assets. | May miss deep internal or code-level vulnerabilities; can be time-consuming to discover complex issues. | External penetration tests for websites, mail servers, VPNs, and perimeter services. |

Before a penetration test starts, both the customer and the pentesting team agree on a clear set of **rules of engagement**. These rules are essential to avoid misunderstanding, legal issues, or accidental disruption of business operations. The rules define what systems are in scope, what testing techniques are allowed, what times the tests can take place, what to do if a critical vulnerability is found, and how the results will be reported. Common pentesting rules also include instructions for handling sensitive data and communication during and after the test.

Pentesting is usually performed in structured phases. 

The first phase is **Planning and Reconnaissance**, where the tester gathers information about the target from public sources, like domain names, DNS records, website content, employee emails, or social media. 
In some cases, this step uses both passive and active scanning. 

The second phase is **Scanning**, which involves using automated tools or manual techniques to map the network, identify open ports, services, and vulnerabilities. 

The third phase is **Gaining Access**, where the tester tries to exploit weaknesses to enter the system. Once access is obtained.

The fourth phase, **Maintaining Access**, simulates how long an attacker could stay undetected by setting up backdoors or creating fake accounts. 

The fifth phase is **Analysis and Reporting**, where the tester documents everything: which vulnerabilities were found, how they were exploited, what level of access was gained, and recommendations on how to fix the problems.

While most people think of penetration testing as something that happens on computers and networks, there is also physical **penetration testing**. In this type of test, security professionals attempt to physically breach the security of buildings, offices, or data centers. The goal is to test the effectiveness of physical controls such as locks, security guards, surveillance cameras, access badges, alarms, and visitor procedures. Physical pentesting can include techniques like lock picking, tailgating (following an authorized person into a secured area), bypassing access controls, social engineering (like pretending to be a delivery person), and even planting hardware devices like rogue Wi-Fi access points or USB drop attacks. Physical penetration testing helps organizations understand how secure their premises are against both casual and targeted intrusions, and whether their staff is following proper security protocols.

:necktie: Overall, penetration testing is a critical part of modern cybersecurity programs. Whether the focus is digital systems, web applications, wireless networks, cloud environments, or physical access, the objective is always the same: simulate an attack in a safe and controlled way to detect weak points before someone malicious does. Penetration tests should always end with a clear, structured report that explains not just the technical problems found, but also the business risk and the recommended fix for each issue. This way the organization can prioritize remediation and improve its security posture in a continuous cycle of assessment, fixing, and retesting.

The terms Red Team, Blue Team, and Purple Team describe roles and exercises designed to improve an organization’s defense against real-world attacks. Each “team” has a specific function in the security testing process, and together they create a cycle of attack, defense, and learning that helps organizations strengthen their security posture.

| Team | Role | Main Activities | Tools & Techniques | Goal | Collaboration Style |
|------|------|----------------|--------------------|------|---------------------|
| **Red Team** | Acts like an advanced attacker, simulating real-world cyberattacks against systems, networks, apps, and people. | Intelligence gathering, exploiting vulnerabilities, social engineering, phishing, bypassing physical security, planting rogue devices, pivoting between systems. | Exploit frameworks, phishing kits, malware, rogue devices, stealth techniques. | Test how well the organization can detect and respond to advanced, realistic attacks without warning. | Works covertly, usually without SOC/IT staff knowledge. |
| **Blue Team** | Defensive security team monitoring and protecting systems in real time. | Log analysis, intrusion detection, monitoring SIEM alerts, stopping attacks, containing threats, investigating incidents, hardening systems, patching, training users. | IDS/IPS, SIEM platforms, endpoint protection, threat intelligence, monitoring tools. | Reduce attack surface, detect intrusions early, respond effectively, and improve defenses over time. | Works continuously, reacts to Red Team attacks when they happen. |
| **Purple Team** | Bridge between Red and Blue Teams to improve collaboration and effectiveness. | Documenting attacks step by step, explaining techniques, showing Blue Team how attacks worked, suggesting detection & prevention improvements. | Reporting tools, knowledge-sharing platforms, simulations, collaborative exercises. | Accelerate learning, strengthen detection & prevention, ensure Red-Blue collaboration. | Works side by side with both teams, often more of an approach than a separate team. |

:necktie: Red, Blue, and Purple teaming exercises are extremely valuable because they move security from theory to practice. A company might have the best security policies on paper, but until a Red Team tests them and a Blue Team defends against them, no one knows how those defenses will hold up under real attack conditions. Red Teams show what an attacker can do, Blue Teams show how well the defenses hold up, and Purple Teams make sure everyone learns and improves after every test. Together, these teams form a continuous loop of improvement that helps organizations prepare for real cyber threats.

### Open Questions ###

1. What is the main goal of penetration testing?  
<details>  
  <summary>Show answer</summary>  
The main goal of penetration testing is to safely simulate real-world cyberattacks to find and fix vulnerabilities before malicious attackers exploit them.  
</details>  

2. Why do companies allow ethical hackers to perform penetration tests on their systems?  
<details>  
  <summary>Show answer</summary>  
Companies allow ethical hackers to perform penetration tests to uncover weaknesses in a controlled environment and strengthen their defenses.  
</details>  

3. What are the three most common types of penetration testing based on knowledge shared with the tester?  
<details>  
  <summary>Show answer</summary>  
The three most common types of penetration testing are white box, gray box, and black box testing.  
</details>  

4. In white box testing, what kind of information is typically shared with the pentester?  
<details>  
  <summary>Show answer</summary>  
In white box testing, the pentester is given full knowledge of the target system, including source code, architecture diagrams, and configuration files.  
</details>  

5. What real-world scenario does gray box testing aim to simulate?  
<details>  
  <summary>Show answer</summary>  
Gray box testing simulates the scenario where an attacker has limited insider knowledge or access, similar to a compromised employee account or partial system breach.  
</details>  

6. Why is black box testing useful for testing public-facing systems?  
<details>  
  <summary>Show answer</summary>  
Black box testing is useful for assessing the security of public-facing systems, because it mimics how an external attacker would approach the target without any prior knowledge.  
</details>  

7. What is the purpose of defining “rules of engagement” before starting a penetration test?  
<details>  
  <summary>Show answer</summary>  
Defining rules of engagement helps ensure that both the tester and the organization are clear on what is allowed, what systems are in scope, and how to handle risks or discoveries during the test.  
</details>  

8. What happens during the Planning and Reconnaissance phase of a penetration test?  
<details>  
  <summary>Show answer</summary>  
During the Planning and Reconnaissance phase, testers gather public information about the target, such as domain names, open services, and employee details.  
</details>  

9. What does the Scanning phase of a penetration test focus on?  
<details>  
  <summary>Show answer</summary>  
The Scanning phase focuses on identifying open ports, active services, and potential vulnerabilities using automated tools and manual techniques.  
</details>  

10. What is the Gaining Access phase designed to test in a penetration test?  
<details>  
  <summary>Show answer</summary>  
The Gaining Access phase tests whether the identified vulnerabilities can be exploited to enter or control the target system.  
</details>  

---

## 6.2.3 Log Reviews ##

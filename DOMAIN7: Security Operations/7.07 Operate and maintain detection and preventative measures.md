## 7.7.1 Firewalls (e.g. next generation, web application, network) ##

To grasp the significance of firewalls, let’s start by reframing them. A firewall isn’t just a bouncer at the digital door. It’s more like a customs officer: it doesn’t just allow or deny entry, it inspects intent, history, and content. The firewall's job is not merely to say “yes” or “no” to network traffic—it’s to make informed, policy-based decisions about what is trusted, what is suspect, and what must be stopped cold.

:bulb: Firewalls are central in the Operate and Maintain phase of security operations: they are policy enforcers, real-time monitors, and response triggers all at once.

Network firewalls are the most familiar type to security professionals. Positioned at the edge of a network or between zones of different trust levels, they enforce security policies based on IP addresses, ports, and protocols.

Modern network firewalls maintain state tables to track the status of active connections. Instead of evaluating each packet in isolation, they understand whether a packet is part of an established session. This context is crucial to detecting anomalies like unsolicited SYN packets or protocol mismatches.

In the operate phase, security teams monitor logs and alerts generated by these stateful inspections. For example, a surge in dropped packets from a specific IP range may indicate a scanning attempt. That’s a detection signal that feeds into broader SIEM systems.

Where traditional firewalls stop at transport layer rules, **Next-Generation Firewalls (NGFWs)** go deeper—examining application-level data, enforcing user-based policies, and integrating with intrusion prevention systems (IPS). You can think of NGFWs as firewalls with X-ray vision. They can differentiate between Skype and Zoom traffic, even if both use the same port. They can apply different policies depending on whether the user is in HR or Finance. They can detect known attack patterns in real time.

NGFWs are tools of both detection and prevention. Their deep inspection capabilities can spot malformed packets or payloads matching malware signatures. Their integrated IPS modules might automatically block or quarantine malicious activity.

But these features must be continuously maintained: signatures must be updated, policies reviewed, performance monitored. If the application layer rules are outdated, you risk allowing dangerous traffic just because it “looks” like a known app.

| **NGFW Feature**          | **Maintenance Task**                        |
| ------------------------- | ------------------------------------------- |
| Application control       | Regular review of allowed/disallowed apps   |
| User identity awareness   | Sync with directory services (e.g., AD)     |
| Threat intelligence feeds | Ensure timely signature updates             |
| Policy enforcement        | Audit rule sets for scope and effectiveness |

**Web Application Firewalls (WAFs)** operate at Layer 7 (Application Layer) and are tuned to stop web-specific threats like SQL injection, cross-site scripting (XSS), and session hijacking. WAFs don’t care whether a packet is TCP or UDP—they care if the input field on your login page is receiving unexpected SQL syntax. They act more like a grammar teacher correcting malicious input than a bouncer at the door.

Public-facing applications are perpetual targets. Attackers use automated scanners to look for common vulnerabilities. A WAF not only blocks many of these, but also logs detailed records of attempts, including request headers and payloads. These logs are a goldmine during incident reviews. From a maintenance standpoint, WAF rules must evolve. Custom applications change frequently, and so must the rules that protect them. An overly strict WAF can break functionality; too loose, and it becomes ineffective.

One of the most powerful features of modern firewalls is not just blocking traffic, but telling you why. Logs and alerts generated by firewalls are essential detection artifacts. A mature security team doesn’t just configure firewalls and walk away. They watch them. They learn from them. Patterns in firewall logs can indicate insider threats, lateral movement, or data exfiltration attempts. But only if someone is looking—and knows what to look for. This is where integration with SIEM platforms, playbooks, and runbooks comes in. A spike in denied outbound connections to a known malicious IP? That’s not just a rule hit—it’s potentially command-and-control activity.

:necktie: Despite all this technology, firewalls are only as effective as the people configuring and maintaining them. Misconfigured rules are a common root cause of breaches. A single “allow all” rule buried deep in a policy can silently undo your entire defense strategy.

:necktie: A security professional must advocate for firewall change management, regular reviews, and role-based access to firewall consoles. Firewall logs should be part of incident response investigations. Firewall rules should align with the organization’s least privilege principle.

### Open Questions ###

1. What is the key operational difference between a traditional network firewall and a next-generation firewall (NGFW)?

<details> <summary>Show answer</summary> A traditional network firewall filters traffic based on IP addresses, ports, and protocols (Layer 3/4), while a next-generation firewall (NGFW) adds application-layer inspection (Layer 7), user identity awareness, and integrated intrusion prevention capabilities. This enables more granular and context-aware security control. </details>

2. Why is continuous rule and policy review important in firewall maintenance?

<details> <summary>Show answer</summary> Because outdated or misconfigured firewall rules can create security gaps or operational disruptions, and regular reviews ensure that access control remains aligned with the organization’s security posture and business needs. </details>

3. How do Web Application Firewalls (WAFs) help prevent common web-based attacks?

<details> <summary>Show answer</summary> WAFs inspect HTTP/HTTPS traffic at the application layer, filtering out malicious payloads such as SQL injection, cross-site scripting (XSS), and command injection before they reach the web server, thus protecting web applications from common exploitation techniques. </details>

4. What role do firewall logs play in incident detection and response?

<details> <summary>Show answer</summary> Firewall logs provide visibility into allowed and denied traffic, helping analysts identify unusual patterns, unauthorized access attempts, or indicators of compromise. They are essential for proactive detection and forensic investigation during incidents. </details>

5. Why is stateful inspection preferred over simple packet filtering in many environments?

<details> <summary>Show answer</summary> Stateful inspection tracks the context of a network connection, ensuring that only valid, established sessions are allowed. This prevents spoofing and session hijacking attacks that stateless packet filters might miss. </details>

6. Give an example of how a misconfigured firewall rule can create a vulnerability.

<details> <summary>Show answer</summary> If a rule is too broad (e.g., allow any any), it may inadvertently permit all incoming or outgoing traffic, bypassing intended restrictions and potentially allowing malware to enter or sensitive data to exit the network. </details>

7. What maintenance actions should be regularly performed on a Next-Generation Firewall?

<details> <summary>Show answer</summary> Regular actions include updating threat intelligence signatures, reviewing and tuning policies, syncing with identity directories, analyzing logs, and verifying the performance and reliability of intrusion prevention features. </details>

8. How does firewall integration with SIEM systems enhance operational security?

<details> <summary>Show answer</summary> It allows firewall events to be correlated with other security data across the enterprise, enabling faster detection of complex threats, centralized alerting, and more effective incident response through contextual awareness. </details>

---

## 7.7.2 Intrusion Detection Systems (IDS) and Intrusion Prevention Systems (IPS) ##



